/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "app/api/bookings/route";
exports.ids = ["app/api/bookings/route"];
exports.modules = {

/***/ "@prisma/client":
/*!*********************************!*\
  !*** external "@prisma/client" ***!
  \*********************************/
/***/ ((module) => {

"use strict";
module.exports = require("@prisma/client");

/***/ }),

/***/ "next/dist/compiled/next-server/app-page.runtime.dev.js":
/*!*************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-page.runtime.dev.js" ***!
  \*************************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/compiled/next-server/app-page.runtime.dev.js");

/***/ }),

/***/ "next/dist/compiled/next-server/app-route.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-route.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/compiled/next-server/app-route.runtime.dev.js");

/***/ }),

/***/ "../app-render/work-async-storage.external":
/*!*****************************************************************************!*\
  !*** external "next/dist/server/app-render/work-async-storage.external.js" ***!
  \*****************************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/server/app-render/work-async-storage.external.js");

/***/ }),

/***/ "./work-unit-async-storage.external":
/*!**********************************************************************************!*\
  !*** external "next/dist/server/app-render/work-unit-async-storage.external.js" ***!
  \**********************************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/server/app-render/work-unit-async-storage.external.js");

/***/ }),

/***/ "(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader/index.js?name=app%2Fapi%2Fbookings%2Froute&page=%2Fapi%2Fbookings%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fbookings%2Froute.js&appDir=%2FUsers%2Fjosephcornell%2FDesktop%2F476GithubRepo%2FdriveshareRepo%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Fjosephcornell%2FDesktop%2F476GithubRepo%2FdriveshareRepo&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!":
/*!************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-app-loader/index.js?name=app%2Fapi%2Fbookings%2Froute&page=%2Fapi%2Fbookings%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fbookings%2Froute.js&appDir=%2FUsers%2Fjosephcornell%2FDesktop%2F476GithubRepo%2FdriveshareRepo%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Fjosephcornell%2FDesktop%2F476GithubRepo%2FdriveshareRepo&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D! ***!
  \************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   patchFetch: () => (/* binding */ patchFetch),\n/* harmony export */   routeModule: () => (/* binding */ routeModule),\n/* harmony export */   serverHooks: () => (/* binding */ serverHooks),\n/* harmony export */   workAsyncStorage: () => (/* binding */ workAsyncStorage),\n/* harmony export */   workUnitAsyncStorage: () => (/* binding */ workUnitAsyncStorage)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/route-modules/app-route/module.compiled */ \"(rsc)/./node_modules/next/dist/server/route-modules/app-route/module.compiled.js\");\n/* harmony import */ var next_dist_server_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/route-kind */ \"(rsc)/./node_modules/next/dist/server/route-kind.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/server/lib/patch-fetch */ \"(rsc)/./node_modules/next/dist/server/lib/patch-fetch.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var _Users_josephcornell_Desktop_476GithubRepo_driveshareRepo_app_api_bookings_route_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./app/api/bookings/route.js */ \"(rsc)/./app/api/bookings/route.js\");\n\n\n\n\n// We inject the nextConfigOutput here so that we can use them in the route\n// module.\nconst nextConfigOutput = \"\"\nconst routeModule = new next_dist_server_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__.AppRouteRouteModule({\n    definition: {\n        kind: next_dist_server_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.APP_ROUTE,\n        page: \"/api/bookings/route\",\n        pathname: \"/api/bookings\",\n        filename: \"route\",\n        bundlePath: \"app/api/bookings/route\"\n    },\n    resolvedPagePath: \"/Users/josephcornell/Desktop/476GithubRepo/driveshareRepo/app/api/bookings/route.js\",\n    nextConfigOutput,\n    userland: _Users_josephcornell_Desktop_476GithubRepo_driveshareRepo_app_api_bookings_route_js__WEBPACK_IMPORTED_MODULE_3__\n});\n// Pull out the exports that we need to expose from the module. This should\n// be eliminated when we've moved the other routes to the new format. These\n// are used to hook into the route.\nconst { workAsyncStorage, workUnitAsyncStorage, serverHooks } = routeModule;\nfunction patchFetch() {\n    return (0,next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__.patchFetch)({\n        workAsyncStorage,\n        workUnitAsyncStorage\n    });\n}\n\n\n//# sourceMappingURL=app-route.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LWFwcC1sb2FkZXIvaW5kZXguanM/bmFtZT1hcHAlMkZhcGklMkZib29raW5ncyUyRnJvdXRlJnBhZ2U9JTJGYXBpJTJGYm9va2luZ3MlMkZyb3V0ZSZhcHBQYXRocz0mcGFnZVBhdGg9cHJpdmF0ZS1uZXh0LWFwcC1kaXIlMkZhcGklMkZib29raW5ncyUyRnJvdXRlLmpzJmFwcERpcj0lMkZVc2VycyUyRmpvc2VwaGNvcm5lbGwlMkZEZXNrdG9wJTJGNDc2R2l0aHViUmVwbyUyRmRyaXZlc2hhcmVSZXBvJTJGYXBwJnBhZ2VFeHRlbnNpb25zPXRzeCZwYWdlRXh0ZW5zaW9ucz10cyZwYWdlRXh0ZW5zaW9ucz1qc3gmcGFnZUV4dGVuc2lvbnM9anMmcm9vdERpcj0lMkZVc2VycyUyRmpvc2VwaGNvcm5lbGwlMkZEZXNrdG9wJTJGNDc2R2l0aHViUmVwbyUyRmRyaXZlc2hhcmVSZXBvJmlzRGV2PXRydWUmdHNjb25maWdQYXRoPXRzY29uZmlnLmpzb24mYmFzZVBhdGg9JmFzc2V0UHJlZml4PSZuZXh0Q29uZmlnT3V0cHV0PSZwcmVmZXJyZWRSZWdpb249Jm1pZGRsZXdhcmVDb25maWc9ZTMwJTNEISIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7OztBQUErRjtBQUN2QztBQUNxQjtBQUNtQztBQUNoSDtBQUNBO0FBQ0E7QUFDQSx3QkFBd0IseUdBQW1CO0FBQzNDO0FBQ0EsY0FBYyxrRUFBUztBQUN2QjtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsWUFBWTtBQUNaLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQSxRQUFRLHNEQUFzRDtBQUM5RDtBQUNBLFdBQVcsNEVBQVc7QUFDdEI7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUMwRjs7QUFFMUYiLCJzb3VyY2VzIjpbIiJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBBcHBSb3V0ZVJvdXRlTW9kdWxlIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvcm91dGUtbW9kdWxlcy9hcHAtcm91dGUvbW9kdWxlLmNvbXBpbGVkXCI7XG5pbXBvcnQgeyBSb3V0ZUtpbmQgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9yb3V0ZS1raW5kXCI7XG5pbXBvcnQgeyBwYXRjaEZldGNoIGFzIF9wYXRjaEZldGNoIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvbGliL3BhdGNoLWZldGNoXCI7XG5pbXBvcnQgKiBhcyB1c2VybGFuZCBmcm9tIFwiL1VzZXJzL2pvc2VwaGNvcm5lbGwvRGVza3RvcC80NzZHaXRodWJSZXBvL2RyaXZlc2hhcmVSZXBvL2FwcC9hcGkvYm9va2luZ3Mvcm91dGUuanNcIjtcbi8vIFdlIGluamVjdCB0aGUgbmV4dENvbmZpZ091dHB1dCBoZXJlIHNvIHRoYXQgd2UgY2FuIHVzZSB0aGVtIGluIHRoZSByb3V0ZVxuLy8gbW9kdWxlLlxuY29uc3QgbmV4dENvbmZpZ091dHB1dCA9IFwiXCJcbmNvbnN0IHJvdXRlTW9kdWxlID0gbmV3IEFwcFJvdXRlUm91dGVNb2R1bGUoe1xuICAgIGRlZmluaXRpb246IHtcbiAgICAgICAga2luZDogUm91dGVLaW5kLkFQUF9ST1VURSxcbiAgICAgICAgcGFnZTogXCIvYXBpL2Jvb2tpbmdzL3JvdXRlXCIsXG4gICAgICAgIHBhdGhuYW1lOiBcIi9hcGkvYm9va2luZ3NcIixcbiAgICAgICAgZmlsZW5hbWU6IFwicm91dGVcIixcbiAgICAgICAgYnVuZGxlUGF0aDogXCJhcHAvYXBpL2Jvb2tpbmdzL3JvdXRlXCJcbiAgICB9LFxuICAgIHJlc29sdmVkUGFnZVBhdGg6IFwiL1VzZXJzL2pvc2VwaGNvcm5lbGwvRGVza3RvcC80NzZHaXRodWJSZXBvL2RyaXZlc2hhcmVSZXBvL2FwcC9hcGkvYm9va2luZ3Mvcm91dGUuanNcIixcbiAgICBuZXh0Q29uZmlnT3V0cHV0LFxuICAgIHVzZXJsYW5kXG59KTtcbi8vIFB1bGwgb3V0IHRoZSBleHBvcnRzIHRoYXQgd2UgbmVlZCB0byBleHBvc2UgZnJvbSB0aGUgbW9kdWxlLiBUaGlzIHNob3VsZFxuLy8gYmUgZWxpbWluYXRlZCB3aGVuIHdlJ3ZlIG1vdmVkIHRoZSBvdGhlciByb3V0ZXMgdG8gdGhlIG5ldyBmb3JtYXQuIFRoZXNlXG4vLyBhcmUgdXNlZCB0byBob29rIGludG8gdGhlIHJvdXRlLlxuY29uc3QgeyB3b3JrQXN5bmNTdG9yYWdlLCB3b3JrVW5pdEFzeW5jU3RvcmFnZSwgc2VydmVySG9va3MgfSA9IHJvdXRlTW9kdWxlO1xuZnVuY3Rpb24gcGF0Y2hGZXRjaCgpIHtcbiAgICByZXR1cm4gX3BhdGNoRmV0Y2goe1xuICAgICAgICB3b3JrQXN5bmNTdG9yYWdlLFxuICAgICAgICB3b3JrVW5pdEFzeW5jU3RvcmFnZVxuICAgIH0pO1xufVxuZXhwb3J0IHsgcm91dGVNb2R1bGUsIHdvcmtBc3luY1N0b3JhZ2UsIHdvcmtVbml0QXN5bmNTdG9yYWdlLCBzZXJ2ZXJIb29rcywgcGF0Y2hGZXRjaCwgIH07XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWFwcC1yb3V0ZS5qcy5tYXAiXSwibmFtZXMiOltdLCJpZ25vcmVMaXN0IjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader/index.js?name=app%2Fapi%2Fbookings%2Froute&page=%2Fapi%2Fbookings%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fbookings%2Froute.js&appDir=%2FUsers%2Fjosephcornell%2FDesktop%2F476GithubRepo%2FdriveshareRepo%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Fjosephcornell%2FDesktop%2F476GithubRepo%2FdriveshareRepo&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!\n");

/***/ }),

/***/ "(rsc)/./node_modules/next/dist/build/webpack/loaders/next-flight-client-entry-loader.js?server=true!":
/*!******************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-flight-client-entry-loader.js?server=true! ***!
  \******************************************************************************************************/
/***/ (() => {



/***/ }),

/***/ "(ssr)/./node_modules/next/dist/build/webpack/loaders/next-flight-client-entry-loader.js?server=true!":
/*!******************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-flight-client-entry-loader.js?server=true! ***!
  \******************************************************************************************************/
/***/ (() => {



/***/ }),

/***/ "(rsc)/./app/api/bookings/route.js":
/*!***********************************!*\
  !*** ./app/api/bookings/route.js ***!
  \***********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   GET: () => (/* binding */ GET),\n/* harmony export */   POST: () => (/* binding */ POST)\n/* harmony export */ });\n/* harmony import */ var _lib_prisma__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @/lib/prisma */ \"(rsc)/./lib/prisma.js\");\n/* harmony import */ var _lib_authMiddleware__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/lib/authMiddleware */ \"(rsc)/./lib/authMiddleware.js\");\n/* harmony import */ var _lib_BookingController__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @/lib/BookingController */ \"(rsc)/./lib/BookingController.js\");\n/* harmony import */ var _lib_OwnerBookingNotificationSubscriber__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @/lib/OwnerBookingNotificationSubscriber */ \"(rsc)/./lib/OwnerBookingNotificationSubscriber.js\");\n/* harmony import */ var _lib_RenterBookingNotificationSubscriber__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @/lib/RenterBookingNotificationSubscriber */ \"(rsc)/./lib/RenterBookingNotificationSubscriber.js\");\n\n\n\n\n\nasync function POST(req) {\n    const auth = await (0,_lib_authMiddleware__WEBPACK_IMPORTED_MODULE_1__.authenticate)(req);\n    if (auth.status !== 200) {\n        return new Response(JSON.stringify(auth.body), {\n            status: auth.status\n        });\n    }\n    const { carId, startDate, endDate } = await req.json();\n    //Find the car\n    const car = await _lib_prisma__WEBPACK_IMPORTED_MODULE_0__[\"default\"].car.findUnique({\n        where: {\n            id: carId\n        }\n    });\n    if (!car) {\n        return new Response(JSON.stringify({\n            error: 'Car not found'\n        }), {\n            status: 404\n        });\n    }\n    if (car.ownerId === auth.userId) {\n        return new Response(JSON.stringify({\n            error: 'Cannot book your own car'\n        }), {\n            status: 403\n        });\n    }\n    //Check for overlapping bookings\n    const overlapping = await _lib_prisma__WEBPACK_IMPORTED_MODULE_0__[\"default\"].booking.findFirst({\n        where: {\n            carId,\n            AND: [\n                {\n                    startDate: {\n                        lt: new Date(endDate)\n                    }\n                },\n                {\n                    endDate: {\n                        gt: new Date(startDate)\n                    }\n                },\n                {\n                    status: {\n                        not: \"cancelled\"\n                    }\n                }\n            ]\n        }\n    });\n    if (overlapping) {\n        return new Response(JSON.stringify({\n            error: 'This car is already booked during the selected dates.'\n        }), {\n            status: 409\n        });\n    }\n    //Validate booking is within the car's availability window\n    if (new Date(startDate) < new Date(car.availableFrom) || new Date(endDate) > new Date(car.availableTo)) {\n        return new Response(JSON.stringify({\n            error: 'Booking must be within the car’s availability window.'\n        }), {\n            status: 400\n        });\n    }\n    //Calculate cost based on hourly rate\n    const start = new Date(startDate);\n    const end = new Date(endDate);\n    const durationHours = (end - start) / (1000 * 60 * 60);\n    const cost = Math.ceil(durationHours * car.pricePerHour);\n    console.log('Booking cost calculation:', {\n        bookingStart: start,\n        bookingEnd: end,\n        durationHours,\n        pricePerHour: car.pricePerHour,\n        cost\n    });\n    //Create the booking\n    const booking = await _lib_prisma__WEBPACK_IMPORTED_MODULE_0__[\"default\"].booking.create({\n        data: {\n            carId,\n            renterId: auth.userId,\n            startDate: start,\n            endDate: end,\n            status: 'pending',\n            cost,\n            paymentStatus: 'unpaid'\n        }\n    });\n    //notification code \n    await _lib_BookingController__WEBPACK_IMPORTED_MODULE_2__[\"default\"].subscribe(booking.id, car.ownerId, 'owner');\n    await _lib_BookingController__WEBPACK_IMPORTED_MODULE_2__[\"default\"].subscribe(booking.id, auth.userId, 'renter');\n    await _lib_BookingController__WEBPACK_IMPORTED_MODULE_2__[\"default\"].notifyEvent('bookingCreated', booking);\n    return new Response(JSON.stringify({\n        booking,\n        cost\n    }), {\n        status: 201\n    });\n}\nasync function GET(req) {\n    //Authenticate the request\n    const auth = await (0,_lib_authMiddleware__WEBPACK_IMPORTED_MODULE_1__.authenticate)(req);\n    if (auth.status !== 200) {\n        return new Response(JSON.stringify(auth.body), {\n            status: auth.status\n        });\n    }\n    try {\n        const { searchParams } = new URL(req.url);\n        const carId = searchParams.get('carId');\n        let bookings;\n        if (carId) {\n            //If carId is provided, return bookings for that car\n            bookings = await _lib_prisma__WEBPACK_IMPORTED_MODULE_0__[\"default\"].booking.findMany({\n                where: {\n                    carId: Number(carId)\n                },\n                orderBy: {\n                    startDate: 'asc'\n                }\n            });\n        } else {\n            //If no carId is provided, return bookings for which the authenticated user is the renter\n            bookings = await _lib_prisma__WEBPACK_IMPORTED_MODULE_0__[\"default\"].booking.findMany({\n                where: {\n                    renterId: auth.userId\n                },\n                orderBy: {\n                    startDate: 'asc'\n                }\n            });\n        }\n        console.log(bookings);\n        return new Response(JSON.stringify({\n            bookings\n        }), {\n            status: 200,\n            headers: {\n                \"Content-Type\": \"application/json\"\n            }\n        });\n    } catch (error) {\n        console.error(\"Error fetching bookings:\", error);\n        return new Response(JSON.stringify({\n            error: \"Failed to fetch bookings\"\n        }), {\n            status: 500\n        });\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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LElBQUkvQyxTQUFTQyxLQUFLQyxTQUFTLENBQUM7WUFBRTZDO1FBQVMsSUFBSTtZQUNoRGhELFFBQVE7WUFDUm9ELFNBQVM7Z0JBQUUsZ0JBQWdCO1lBQW1CO1FBQ2hEO0lBQ0YsRUFBRSxPQUFPdkMsT0FBTztRQUNkb0IsUUFBUXBCLEtBQUssQ0FBQyw0QkFBNEJBO1FBQzFDLE9BQU8sSUFBSVosU0FBU0MsS0FBS0MsU0FBUyxDQUFDO1lBQUVVLE9BQU87UUFBMkIsSUFBSTtZQUFFYixRQUFRO1FBQUk7SUFDM0Y7QUFDRiIsInNvdXJjZXMiOlsiL1VzZXJzL2pvc2VwaGNvcm5lbGwvRGVza3RvcC80NzZHaXRodWJSZXBvL2RyaXZlc2hhcmVSZXBvL2FwcC9hcGkvYm9va2luZ3Mvcm91dGUuanMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHByaXNtYSBmcm9tICdAL2xpYi9wcmlzbWEnO1xuaW1wb3J0IHsgYXV0aGVudGljYXRlIH0gZnJvbSAnQC9saWIvYXV0aE1pZGRsZXdhcmUnO1xuaW1wb3J0IEJvb2tpbmdDb250cm9sbGVyIGZyb20gJ0AvbGliL0Jvb2tpbmdDb250cm9sbGVyJztcbmltcG9ydCBPd25lckJvb2tpbmdOb3RpZmljYXRpb25TdWJzY3JpYmVyIGZyb20gJ0AvbGliL093bmVyQm9va2luZ05vdGlmaWNhdGlvblN1YnNjcmliZXInO1xuaW1wb3J0IFJlbnRlckJvb2tpbmdOb3RpZmljYXRpb25TdWJzY3JpYmVyIGZyb20gJ0AvbGliL1JlbnRlckJvb2tpbmdOb3RpZmljYXRpb25TdWJzY3JpYmVyJztcblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIFBPU1QocmVxKSB7XG4gIGNvbnN0IGF1dGggPSBhd2FpdCBhdXRoZW50aWNhdGUocmVxKTtcbiAgaWYgKGF1dGguc3RhdHVzICE9PSAyMDApIHtcbiAgICByZXR1cm4gbmV3IFJlc3BvbnNlKEpTT04uc3RyaW5naWZ5KGF1dGguYm9keSksIHsgc3RhdHVzOiBhdXRoLnN0YXR1cyB9KTtcbiAgfVxuXG4gIGNvbnN0IHsgY2FySWQsIHN0YXJ0RGF0ZSwgZW5kRGF0ZSB9ID0gYXdhaXQgcmVxLmpzb24oKTtcblxuICAvL0ZpbmQgdGhlIGNhclxuICBjb25zdCBjYXIgPSBhd2FpdCBwcmlzbWEuY2FyLmZpbmRVbmlxdWUoeyB3aGVyZTogeyBpZDogY2FySWQgfSB9KTtcbiAgaWYgKCFjYXIpIHtcbiAgICByZXR1cm4gbmV3IFJlc3BvbnNlKEpTT04uc3RyaW5naWZ5KHsgZXJyb3I6ICdDYXIgbm90IGZvdW5kJyB9KSwgeyBzdGF0dXM6IDQwNCB9KTtcbiAgfVxuICBpZiAoY2FyLm93bmVySWQgPT09IGF1dGgudXNlcklkKSB7XG4gICAgcmV0dXJuIG5ldyBSZXNwb25zZShKU09OLnN0cmluZ2lmeSh7IGVycm9yOiAnQ2Fubm90IGJvb2sgeW91ciBvd24gY2FyJyB9KSwgeyBzdGF0dXM6IDQwMyB9KTtcbiAgfVxuXG4gIC8vQ2hlY2sgZm9yIG92ZXJsYXBwaW5nIGJvb2tpbmdzXG4gIGNvbnN0IG92ZXJsYXBwaW5nID0gYXdhaXQgcHJpc21hLmJvb2tpbmcuZmluZEZpcnN0KHtcbiAgICB3aGVyZToge1xuICAgICAgY2FySWQsXG4gICAgICBBTkQ6IFtcbiAgICAgICAgeyBzdGFydERhdGU6IHsgbHQ6IG5ldyBEYXRlKGVuZERhdGUpIH0gfSxcbiAgICAgICAgeyBlbmREYXRlOiB7IGd0OiBuZXcgRGF0ZShzdGFydERhdGUpIH0gfSxcbiAgICAgICAgeyBzdGF0dXM6IHsgbm90OiBcImNhbmNlbGxlZFwiIH0gfSBcbiAgICAgIF1cbiAgICB9XG4gIH0pO1xuICBpZiAob3ZlcmxhcHBpbmcpIHtcbiAgICByZXR1cm4gbmV3IFJlc3BvbnNlKFxuICAgICAgSlNPTi5zdHJpbmdpZnkoeyBlcnJvcjogJ1RoaXMgY2FyIGlzIGFscmVhZHkgYm9va2VkIGR1cmluZyB0aGUgc2VsZWN0ZWQgZGF0ZXMuJyB9KSxcbiAgICAgIHsgc3RhdHVzOiA0MDkgfVxuICAgICk7XG4gIH1cblxuICAvL1ZhbGlkYXRlIGJvb2tpbmcgaXMgd2l0aGluIHRoZSBjYXIncyBhdmFpbGFiaWxpdHkgd2luZG93XG4gIGlmIChcbiAgICBuZXcgRGF0ZShzdGFydERhdGUpIDwgbmV3IERhdGUoY2FyLmF2YWlsYWJsZUZyb20pIHx8XG4gICAgbmV3IERhdGUoZW5kRGF0ZSkgPiBuZXcgRGF0ZShjYXIuYXZhaWxhYmxlVG8pXG4gICkge1xuICAgIHJldHVybiBuZXcgUmVzcG9uc2UoXG4gICAgICBKU09OLnN0cmluZ2lmeSh7IGVycm9yOiAnQm9va2luZyBtdXN0IGJlIHdpdGhpbiB0aGUgY2Fy4oCZcyBhdmFpbGFiaWxpdHkgd2luZG93LicgfSksXG4gICAgICB7IHN0YXR1czogNDAwIH1cbiAgICApO1xuICB9XG5cbiAgLy9DYWxjdWxhdGUgY29zdCBiYXNlZCBvbiBob3VybHkgcmF0ZVxuICBjb25zdCBzdGFydCA9IG5ldyBEYXRlKHN0YXJ0RGF0ZSk7XG4gIGNvbnN0IGVuZCA9IG5ldyBEYXRlKGVuZERhdGUpO1xuICBjb25zdCBkdXJhdGlvbkhvdXJzID0gKGVuZCAtIHN0YXJ0KSAvICgxMDAwICogNjAgKiA2MCk7XG4gIGNvbnN0IGNvc3QgPSBNYXRoLmNlaWwoZHVyYXRpb25Ib3VycyAqIGNhci5wcmljZVBlckhvdXIpO1xuXG4gIGNvbnNvbGUubG9nKCdCb29raW5nIGNvc3QgY2FsY3VsYXRpb246Jywge1xuICAgIGJvb2tpbmdTdGFydDogc3RhcnQsXG4gICAgYm9va2luZ0VuZDogZW5kLFxuICAgIGR1cmF0aW9uSG91cnMsXG4gICAgcHJpY2VQZXJIb3VyOiBjYXIucHJpY2VQZXJIb3VyLFxuICAgIGNvc3RcbiAgfSk7XG4gIC8vQ3JlYXRlIHRoZSBib29raW5nXG4gIGNvbnN0IGJvb2tpbmcgPSBhd2FpdCBwcmlzbWEuYm9va2luZy5jcmVhdGUoe1xuICAgIGRhdGE6IHtcbiAgICAgIGNhcklkLFxuICAgICAgcmVudGVySWQ6IGF1dGgudXNlcklkLFxuICAgICAgc3RhcnREYXRlOiBzdGFydCxcbiAgICAgIGVuZERhdGU6IGVuZCxcbiAgICAgIHN0YXR1czogJ3BlbmRpbmcnLFxuICAgICAgY29zdCxcbiAgICAgIHBheW1lbnRTdGF0dXM6ICd1bnBhaWQnXG4gICAgfVxuICB9KTtcblxuXG5cbiAgLy9ub3RpZmljYXRpb24gY29kZSBcblxuICBhd2FpdCBCb29raW5nQ29udHJvbGxlci5zdWJzY3JpYmUoYm9va2luZy5pZCwgY2FyLm93bmVySWQsICdvd25lcicpO1xuICBhd2FpdCBCb29raW5nQ29udHJvbGxlci5zdWJzY3JpYmUoYm9va2luZy5pZCwgYXV0aC51c2VySWQsICdyZW50ZXInKTtcbiAgXG4gIGF3YWl0IEJvb2tpbmdDb250cm9sbGVyLm5vdGlmeUV2ZW50KCdib29raW5nQ3JlYXRlZCcsIGJvb2tpbmcpO1xuICBcblxuXG5cbiAgcmV0dXJuIG5ldyBSZXNwb25zZShKU09OLnN0cmluZ2lmeSh7IGJvb2tpbmcsIGNvc3QgfSksIHsgc3RhdHVzOiAyMDEgfSk7XG59XG5cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIEdFVChyZXEpIHtcbiAgLy9BdXRoZW50aWNhdGUgdGhlIHJlcXVlc3RcbiAgY29uc3QgYXV0aCA9IGF3YWl0IGF1dGhlbnRpY2F0ZShyZXEpO1xuICBpZiAoYXV0aC5zdGF0dXMgIT09IDIwMCkge1xuICAgIHJldHVybiBuZXcgUmVzcG9uc2UoSlNPTi5zdHJpbmdpZnkoYXV0aC5ib2R5KSwgeyBzdGF0dXM6IGF1dGguc3RhdHVzIH0pO1xuICB9XG4gIFxuICB0cnkge1xuICAgIGNvbnN0IHsgc2VhcmNoUGFyYW1zIH0gPSBuZXcgVVJMKHJlcS51cmwpO1xuICAgIGNvbnN0IGNhcklkID0gc2VhcmNoUGFyYW1zLmdldCgnY2FySWQnKTtcbiAgICBsZXQgYm9va2luZ3M7XG4gICAgXG4gICAgaWYgKGNhcklkKSB7XG4gICAgICAvL0lmIGNhcklkIGlzIHByb3ZpZGVkLCByZXR1cm4gYm9va2luZ3MgZm9yIHRoYXQgY2FyXG4gICAgICBib29raW5ncyA9IGF3YWl0IHByaXNtYS5ib29raW5nLmZpbmRNYW55KHtcbiAgICAgICAgd2hlcmU6IHsgY2FySWQ6IE51bWJlcihjYXJJZCkgfSxcbiAgICAgICAgb3JkZXJCeTogeyBzdGFydERhdGU6ICdhc2MnIH1cbiAgICAgIH0pO1xuICAgIH0gZWxzZSB7XG4gICAgICAvL0lmIG5vIGNhcklkIGlzIHByb3ZpZGVkLCByZXR1cm4gYm9va2luZ3MgZm9yIHdoaWNoIHRoZSBhdXRoZW50aWNhdGVkIHVzZXIgaXMgdGhlIHJlbnRlclxuICAgICAgYm9va2luZ3MgPSBhd2FpdCBwcmlzbWEuYm9va2luZy5maW5kTWFueSh7XG4gICAgICAgIHdoZXJlOiB7IHJlbnRlcklkOiBhdXRoLnVzZXJJZCB9LFxuICAgICAgICBvcmRlckJ5OiB7IHN0YXJ0RGF0ZTogJ2FzYycgfVxuICAgICAgfSk7XG4gICAgfVxuICAgIGNvbnNvbGUubG9nKGJvb2tpbmdzKVxuICAgIHJldHVybiBuZXcgUmVzcG9uc2UoSlNPTi5zdHJpbmdpZnkoeyBib29raW5ncyB9KSwge1xuICAgICAgc3RhdHVzOiAyMDAsXG4gICAgICBoZWFkZXJzOiB7IFwiQ29udGVudC1UeXBlXCI6IFwiYXBwbGljYXRpb24vanNvblwiIH1cbiAgICB9KTtcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKFwiRXJyb3IgZmV0Y2hpbmcgYm9va2luZ3M6XCIsIGVycm9yKTtcbiAgICByZXR1cm4gbmV3IFJlc3BvbnNlKEpTT04uc3RyaW5naWZ5KHsgZXJyb3I6IFwiRmFpbGVkIHRvIGZldGNoIGJvb2tpbmdzXCIgfSksIHsgc3RhdHVzOiA1MDAgfSk7XG4gIH1cbn1cbiJdLCJuYW1lcyI6WyJwcmlzbWEiLCJhdXRoZW50aWNhdGUiLCJCb29raW5nQ29udHJvbGxlciIsIk93bmVyQm9va2luZ05vdGlmaWNhdGlvblN1YnNjcmliZXIiLCJSZW50ZXJCb29raW5nTm90aWZpY2F0aW9uU3Vic2NyaWJlciIsIlBPU1QiLCJyZXEiLCJhdXRoIiwic3RhdHVzIiwiUmVzcG9uc2UiLCJKU09OIiwic3RyaW5naWZ5IiwiYm9keSIsImNhcklkIiwic3RhcnREYXRlIiwiZW5kRGF0ZSIsImpzb24iLCJjYXIiLCJmaW5kVW5pcXVlIiwid2hlcmUiLCJpZCIsImVycm9yIiwib3duZXJJZCIsInVzZXJJZCIsIm92ZXJsYXBwaW5nIiwiYm9va2luZyIsImZpbmRGaXJzdCIsIkFORCIsImx0IiwiRGF0ZSIsImd0Iiwibm90IiwiYXZhaWxhYmxlRnJvbSIsImF2YWlsYWJsZVRvIiwic3RhcnQiLCJlbmQiLCJkdXJhdGlvbkhvdXJzIiwiY29zdCIsIk1hdGgiLCJjZWlsIiwicHJpY2VQZXJIb3VyIiwiY29uc29sZSIsImxvZyIsImJvb2tpbmdTdGFydCIsImJvb2tpbmdFbmQiLCJjcmVhdGUiLCJkYXRhIiwicmVudGVySWQiLCJwYXltZW50U3RhdHVzIiwic3Vic2NyaWJlIiwibm90aWZ5RXZlbnQiLCJHRVQiLCJzZWFyY2hQYXJhbXMiLCJVUkwiLCJ1cmwiLCJnZXQiLCJib29raW5ncyIsImZpbmRNYW55IiwiTnVtYmVyIiwib3JkZXJCeSIsImhlYWRlcnMiXSwiaWdub3JlTGlzdCI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./app/api/bookings/route.js\n");

/***/ }),

/***/ "(rsc)/./lib/BookingController.js":
/*!**********************************!*\
  !*** ./lib/BookingController.js ***!
  \**********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony import */ var _prisma__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./prisma */ \"(rsc)/./lib/prisma.js\");\n/* harmony import */ var _OwnerBookingNotificationSubscriber__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./OwnerBookingNotificationSubscriber */ \"(rsc)/./lib/OwnerBookingNotificationSubscriber.js\");\n/* harmony import */ var _RenterBookingNotificationSubscriber__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./RenterBookingNotificationSubscriber */ \"(rsc)/./lib/RenterBookingNotificationSubscriber.js\");\n// lib/BookingController.js\n\n\n\nclass BookingController {\n    // Add one subscriber\n    async subscribe(bookingId, userId, role) {\n        await _prisma__WEBPACK_IMPORTED_MODULE_0__[\"default\"].bookingObserver.create({\n            data: {\n                bookingId,\n                userId,\n                role\n            }\n        });\n    }\n    // Remove one subscriber\n    async unsubscribe(bookingId, userId) {\n        await _prisma__WEBPACK_IMPORTED_MODULE_0__[\"default\"].bookingObserver.deleteMany({\n            where: {\n                bookingId,\n                userId\n            }\n        });\n    }\n    // Notify all current subscribers for this booking\n    async notifyEvent(eventType, booking) {\n        const observers = await _prisma__WEBPACK_IMPORTED_MODULE_0__[\"default\"].bookingObserver.findMany({\n            where: {\n                bookingId: booking.id\n            }\n        });\n        for (const { userId, role } of observers){\n            let subscriber;\n            if (role === 'owner') {\n                subscriber = new _OwnerBookingNotificationSubscriber__WEBPACK_IMPORTED_MODULE_1__[\"default\"](userId);\n            } else if (role === 'renter') {\n                subscriber = new _RenterBookingNotificationSubscriber__WEBPACK_IMPORTED_MODULE_2__[\"default\"](userId);\n            }\n            if (subscriber) {\n                await subscriber.update({\n                    event: eventType,\n                    booking\n                });\n            }\n        }\n    }\n}\n;\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (new BookingController());\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9saWIvQm9va2luZ0NvbnRyb2xsZXIuanMiLCJtYXBwaW5ncyI6Ijs7Ozs7OztBQUFBLDJCQUEyQjtBQUNHO0FBQ3dEO0FBQ0U7QUFFeEYsTUFBTUc7SUFDSixxQkFBcUI7SUFDckIsTUFBTUMsVUFBVUMsU0FBUyxFQUFFQyxNQUFNLEVBQUVDLElBQUksRUFBRTtRQUV2QyxNQUFNUCwrQ0FBTUEsQ0FBQ1EsZUFBZSxDQUFDQyxNQUFNLENBQUM7WUFDbENDLE1BQU07Z0JBQUVMO2dCQUFXQztnQkFBUUM7WUFBSztRQUNsQztJQUNGO0lBRUEsd0JBQXdCO0lBQ3hCLE1BQU1JLFlBQVlOLFNBQVMsRUFBRUMsTUFBTSxFQUFFO1FBQ25DLE1BQU1OLCtDQUFNQSxDQUFDUSxlQUFlLENBQUNJLFVBQVUsQ0FBQztZQUN0Q0MsT0FBTztnQkFBRVI7Z0JBQVdDO1lBQU87UUFDN0I7SUFDRjtJQUVBLGtEQUFrRDtJQUNsRCxNQUFNUSxZQUFZQyxTQUFTLEVBQUVDLE9BQU8sRUFBRTtRQUNwQyxNQUFNQyxZQUFZLE1BQU1qQiwrQ0FBTUEsQ0FBQ1EsZUFBZSxDQUFDVSxRQUFRLENBQUM7WUFDdERMLE9BQU87Z0JBQUVSLFdBQVdXLFFBQVFHLEVBQUU7WUFBQztRQUNqQztRQUVBLEtBQUssTUFBTSxFQUFFYixNQUFNLEVBQUVDLElBQUksRUFBRSxJQUFJVSxVQUFXO1lBQ3hDLElBQUlHO1lBRUosSUFBSWIsU0FBUyxTQUFTO2dCQUNwQmEsYUFBYSxJQUFJbkIsMkVBQWtDQSxDQUFDSztZQUN0RCxPQUFPLElBQUlDLFNBQVMsVUFBVTtnQkFDNUJhLGFBQWEsSUFBSWxCLDRFQUFtQ0EsQ0FBQ0k7WUFDdkQ7WUFFQSxJQUFJYyxZQUFZO2dCQUNkLE1BQU1BLFdBQVdDLE1BQU0sQ0FBQztvQkFBRUMsT0FBT1A7b0JBQVdDO2dCQUFRO1lBQ3REO1FBQ0Y7SUFDRjtBQUNGOztBQUVBLGlFQUFlLElBQUliLG1CQUFtQkEsRUFBQyIsInNvdXJjZXMiOlsiL1VzZXJzL2pvc2VwaGNvcm5lbGwvRGVza3RvcC80NzZHaXRodWJSZXBvL2RyaXZlc2hhcmVSZXBvL2xpYi9Cb29raW5nQ29udHJvbGxlci5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBsaWIvQm9va2luZ0NvbnRyb2xsZXIuanNcbmltcG9ydCBwcmlzbWEgZnJvbSAnLi9wcmlzbWEnO1xuaW1wb3J0IE93bmVyQm9va2luZ05vdGlmaWNhdGlvblN1YnNjcmliZXIgZnJvbSAnLi9Pd25lckJvb2tpbmdOb3RpZmljYXRpb25TdWJzY3JpYmVyJztcbmltcG9ydCBSZW50ZXJCb29raW5nTm90aWZpY2F0aW9uU3Vic2NyaWJlciBmcm9tICcuL1JlbnRlckJvb2tpbmdOb3RpZmljYXRpb25TdWJzY3JpYmVyJztcblxuY2xhc3MgQm9va2luZ0NvbnRyb2xsZXIge1xuICAvLyBBZGQgb25lIHN1YnNjcmliZXJcbiAgYXN5bmMgc3Vic2NyaWJlKGJvb2tpbmdJZCwgdXNlcklkLCByb2xlKSB7XG4gICBcbiAgICBhd2FpdCBwcmlzbWEuYm9va2luZ09ic2VydmVyLmNyZWF0ZSh7XG4gICAgICBkYXRhOiB7IGJvb2tpbmdJZCwgdXNlcklkLCByb2xlIH1cbiAgICB9KTtcbiAgfVxuXG4gIC8vIFJlbW92ZSBvbmUgc3Vic2NyaWJlclxuICBhc3luYyB1bnN1YnNjcmliZShib29raW5nSWQsIHVzZXJJZCkge1xuICAgIGF3YWl0IHByaXNtYS5ib29raW5nT2JzZXJ2ZXIuZGVsZXRlTWFueSh7XG4gICAgICB3aGVyZTogeyBib29raW5nSWQsIHVzZXJJZCB9XG4gICAgfSk7XG4gIH1cblxuICAvLyBOb3RpZnkgYWxsIGN1cnJlbnQgc3Vic2NyaWJlcnMgZm9yIHRoaXMgYm9va2luZ1xuICBhc3luYyBub3RpZnlFdmVudChldmVudFR5cGUsIGJvb2tpbmcpIHtcbiAgICBjb25zdCBvYnNlcnZlcnMgPSBhd2FpdCBwcmlzbWEuYm9va2luZ09ic2VydmVyLmZpbmRNYW55KHtcbiAgICAgIHdoZXJlOiB7IGJvb2tpbmdJZDogYm9va2luZy5pZCB9XG4gICAgfSk7XG5cbiAgICBmb3IgKGNvbnN0IHsgdXNlcklkLCByb2xlIH0gb2Ygb2JzZXJ2ZXJzKSB7XG4gICAgICBsZXQgc3Vic2NyaWJlcjtcblxuICAgICAgaWYgKHJvbGUgPT09ICdvd25lcicpIHtcbiAgICAgICAgc3Vic2NyaWJlciA9IG5ldyBPd25lckJvb2tpbmdOb3RpZmljYXRpb25TdWJzY3JpYmVyKHVzZXJJZCk7XG4gICAgICB9IGVsc2UgaWYgKHJvbGUgPT09ICdyZW50ZXInKSB7XG4gICAgICAgIHN1YnNjcmliZXIgPSBuZXcgUmVudGVyQm9va2luZ05vdGlmaWNhdGlvblN1YnNjcmliZXIodXNlcklkKTtcbiAgICAgIH1cblxuICAgICAgaWYgKHN1YnNjcmliZXIpIHtcbiAgICAgICAgYXdhaXQgc3Vic2NyaWJlci51cGRhdGUoeyBldmVudDogZXZlbnRUeXBlLCBib29raW5nIH0pO1xuICAgICAgfVxuICAgIH1cbiAgfVxufTtcblxuZXhwb3J0IGRlZmF1bHQgbmV3IEJvb2tpbmdDb250cm9sbGVyKCk7XG4iXSwibmFtZXMiOlsicHJpc21hIiwiT3duZXJCb29raW5nTm90aWZpY2F0aW9uU3Vic2NyaWJlciIsIlJlbnRlckJvb2tpbmdOb3RpZmljYXRpb25TdWJzY3JpYmVyIiwiQm9va2luZ0NvbnRyb2xsZXIiLCJzdWJzY3JpYmUiLCJib29raW5nSWQiLCJ1c2VySWQiLCJyb2xlIiwiYm9va2luZ09ic2VydmVyIiwiY3JlYXRlIiwiZGF0YSIsInVuc3Vic2NyaWJlIiwiZGVsZXRlTWFueSIsIndoZXJlIiwibm90aWZ5RXZlbnQiLCJldmVudFR5cGUiLCJib29raW5nIiwib2JzZXJ2ZXJzIiwiZmluZE1hbnkiLCJpZCIsInN1YnNjcmliZXIiLCJ1cGRhdGUiLCJldmVudCJdLCJpZ25vcmVMaXN0IjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./lib/BookingController.js\n");

/***/ }),

/***/ "(rsc)/./lib/OwnerBookingNotificationSubscriber.js":
/*!***************************************************!*\
  !*** ./lib/OwnerBookingNotificationSubscriber.js ***!
  \***************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony import */ var _lib_prisma__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @/lib/prisma */ \"(rsc)/./lib/prisma.js\");\n\nclass OwnerBookingNotificationSubscriber {\n    constructor(ownerId){\n        this.ownerId = ownerId;\n    }\n    // Update signature to accept one object with destructured keys\n    async update({ event, booking }) {\n        console.log(`Owner ${this.ownerId} notified of event \"${event}\" on booking ${booking.id}`);\n        // Persist the notification for the owner in the database.\n        try {\n            await _lib_prisma__WEBPACK_IMPORTED_MODULE_0__[\"default\"].notification.create({\n                data: {\n                    userId: this.ownerId,\n                    content: `Your car (ID: ${booking.carId}) has a new booking event: \"${event}\" (Booking ID: ${booking.id}).`\n                }\n            });\n        } catch (error) {\n            console.error('Error creating owner notification:', error);\n        }\n    }\n}\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (OwnerBookingNotificationSubscriber);\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9saWIvT3duZXJCb29raW5nTm90aWZpY2F0aW9uU3Vic2NyaWJlci5qcyIsIm1hcHBpbmdzIjoiOzs7OztBQUFrQztBQUVsQyxNQUFNQztJQUNKQyxZQUFZQyxPQUFPLENBQUU7UUFDbkIsSUFBSSxDQUFDQSxPQUFPLEdBQUdBO0lBQ2pCO0lBRUEsK0RBQStEO0lBQy9ELE1BQU1DLE9BQU8sRUFBRUMsS0FBSyxFQUFFQyxPQUFPLEVBQUUsRUFBRTtRQUMvQkMsUUFBUUMsR0FBRyxDQUFDLENBQUMsTUFBTSxFQUFFLElBQUksQ0FBQ0wsT0FBTyxDQUFDLG9CQUFvQixFQUFFRSxNQUFNLGFBQWEsRUFBRUMsUUFBUUcsRUFBRSxFQUFFO1FBRXpGLDBEQUEwRDtRQUMxRCxJQUFJO1lBQ0YsTUFBTVQsbURBQU1BLENBQUNVLFlBQVksQ0FBQ0MsTUFBTSxDQUFDO2dCQUMvQkMsTUFBTTtvQkFDSkMsUUFBUSxJQUFJLENBQUNWLE9BQU87b0JBQ3BCVyxTQUFTLENBQUMsY0FBYyxFQUFFUixRQUFRUyxLQUFLLENBQUMsNEJBQTRCLEVBQUVWLE1BQU0sZUFBZSxFQUFFQyxRQUFRRyxFQUFFLENBQUMsRUFBRSxDQUFDO2dCQUM3RztZQUNGO1FBQ0YsRUFBRSxPQUFPTyxPQUFPO1lBQ2RULFFBQVFTLEtBQUssQ0FBQyxzQ0FBc0NBO1FBQ3REO0lBQ0Y7QUFDRjtBQUVBLGlFQUFlZixrQ0FBa0NBLEVBQUMiLCJzb3VyY2VzIjpbIi9Vc2Vycy9qb3NlcGhjb3JuZWxsL0Rlc2t0b3AvNDc2R2l0aHViUmVwby9kcml2ZXNoYXJlUmVwby9saWIvT3duZXJCb29raW5nTm90aWZpY2F0aW9uU3Vic2NyaWJlci5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgcHJpc21hIGZyb20gJ0AvbGliL3ByaXNtYSc7XG5cbmNsYXNzIE93bmVyQm9va2luZ05vdGlmaWNhdGlvblN1YnNjcmliZXIge1xuICBjb25zdHJ1Y3Rvcihvd25lcklkKSB7XG4gICAgdGhpcy5vd25lcklkID0gb3duZXJJZDtcbiAgfVxuXG4gIC8vIFVwZGF0ZSBzaWduYXR1cmUgdG8gYWNjZXB0IG9uZSBvYmplY3Qgd2l0aCBkZXN0cnVjdHVyZWQga2V5c1xuICBhc3luYyB1cGRhdGUoeyBldmVudCwgYm9va2luZyB9KSB7XG4gICAgY29uc29sZS5sb2coYE93bmVyICR7dGhpcy5vd25lcklkfSBub3RpZmllZCBvZiBldmVudCBcIiR7ZXZlbnR9XCIgb24gYm9va2luZyAke2Jvb2tpbmcuaWR9YCk7XG5cbiAgICAvLyBQZXJzaXN0IHRoZSBub3RpZmljYXRpb24gZm9yIHRoZSBvd25lciBpbiB0aGUgZGF0YWJhc2UuXG4gICAgdHJ5IHtcbiAgICAgIGF3YWl0IHByaXNtYS5ub3RpZmljYXRpb24uY3JlYXRlKHtcbiAgICAgICAgZGF0YToge1xuICAgICAgICAgIHVzZXJJZDogdGhpcy5vd25lcklkLFxuICAgICAgICAgIGNvbnRlbnQ6IGBZb3VyIGNhciAoSUQ6ICR7Ym9va2luZy5jYXJJZH0pIGhhcyBhIG5ldyBib29raW5nIGV2ZW50OiBcIiR7ZXZlbnR9XCIgKEJvb2tpbmcgSUQ6ICR7Ym9va2luZy5pZH0pLmBcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGNyZWF0aW5nIG93bmVyIG5vdGlmaWNhdGlvbjonLCBlcnJvcik7XG4gICAgfVxuICB9XG59XG5cbmV4cG9ydCBkZWZhdWx0IE93bmVyQm9va2luZ05vdGlmaWNhdGlvblN1YnNjcmliZXI7XG4iXSwibmFtZXMiOlsicHJpc21hIiwiT3duZXJCb29raW5nTm90aWZpY2F0aW9uU3Vic2NyaWJlciIsImNvbnN0cnVjdG9yIiwib3duZXJJZCIsInVwZGF0ZSIsImV2ZW50IiwiYm9va2luZyIsImNvbnNvbGUiLCJsb2ciLCJpZCIsIm5vdGlmaWNhdGlvbiIsImNyZWF0ZSIsImRhdGEiLCJ1c2VySWQiLCJjb250ZW50IiwiY2FySWQiLCJlcnJvciJdLCJpZ25vcmVMaXN0IjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./lib/OwnerBookingNotificationSubscriber.js\n");

/***/ }),

/***/ "(rsc)/./lib/RenterBookingNotificationSubscriber.js":
/*!****************************************************!*\
  !*** ./lib/RenterBookingNotificationSubscriber.js ***!
  \****************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony import */ var _lib_prisma__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @/lib/prisma */ \"(rsc)/./lib/prisma.js\");\n\nclass RenterBookingNotificationSubscriber {\n    constructor(renterId){\n        this.renterId = renterId;\n    }\n    async update({ event, booking }) {\n        console.log(`Renter ${this.renterId} notified of event \"${event}\" on booking ${booking.id}`);\n        // Persist the notification for the renter.\n        try {\n            await _lib_prisma__WEBPACK_IMPORTED_MODULE_0__[\"default\"].notification.create({\n                data: {\n                    userId: this.renterId,\n                    content: `Your booking (ID: ${booking.id}) for car (ID: ${booking.carId}) has an update: \"${event}\".`\n                }\n            });\n        } catch (error) {\n            console.error('Error creating renter notification:', error);\n        }\n    }\n}\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (RenterBookingNotificationSubscriber);\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9saWIvUmVudGVyQm9va2luZ05vdGlmaWNhdGlvblN1YnNjcmliZXIuanMiLCJtYXBwaW5ncyI6Ijs7Ozs7QUFBa0M7QUFFbEMsTUFBTUM7SUFDSkMsWUFBWUMsUUFBUSxDQUFFO1FBQ3BCLElBQUksQ0FBQ0EsUUFBUSxHQUFHQTtJQUNsQjtJQUVBLE1BQU1DLE9BQU8sRUFBRUMsS0FBSyxFQUFFQyxPQUFPLEVBQUUsRUFBRTtRQUMvQkMsUUFBUUMsR0FBRyxDQUFDLENBQUMsT0FBTyxFQUFFLElBQUksQ0FBQ0wsUUFBUSxDQUFDLG9CQUFvQixFQUFFRSxNQUFNLGFBQWEsRUFBRUMsUUFBUUcsRUFBRSxFQUFFO1FBRTNGLDJDQUEyQztRQUMzQyxJQUFJO1lBQ0YsTUFBTVQsbURBQU1BLENBQUNVLFlBQVksQ0FBQ0MsTUFBTSxDQUFDO2dCQUMvQkMsTUFBTTtvQkFDSkMsUUFBUSxJQUFJLENBQUNWLFFBQVE7b0JBQ3JCVyxTQUFTLENBQUMsa0JBQWtCLEVBQUVSLFFBQVFHLEVBQUUsQ0FBQyxlQUFlLEVBQUVILFFBQVFTLEtBQUssQ0FBQyxrQkFBa0IsRUFBRVYsTUFBTSxFQUFFLENBQUM7Z0JBQ3ZHO1lBQ0Y7UUFDRixFQUFFLE9BQU9XLE9BQU87WUFDZFQsUUFBUVMsS0FBSyxDQUFDLHVDQUF1Q0E7UUFDdkQ7SUFDRjtBQUNGO0FBRUEsaUVBQWVmLG1DQUFtQ0EsRUFBQyIsInNvdXJjZXMiOlsiL1VzZXJzL2pvc2VwaGNvcm5lbGwvRGVza3RvcC80NzZHaXRodWJSZXBvL2RyaXZlc2hhcmVSZXBvL2xpYi9SZW50ZXJCb29raW5nTm90aWZpY2F0aW9uU3Vic2NyaWJlci5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgcHJpc21hIGZyb20gJ0AvbGliL3ByaXNtYSc7XG5cbmNsYXNzIFJlbnRlckJvb2tpbmdOb3RpZmljYXRpb25TdWJzY3JpYmVyIHtcbiAgY29uc3RydWN0b3IocmVudGVySWQpIHtcbiAgICB0aGlzLnJlbnRlcklkID0gcmVudGVySWQ7XG4gIH1cblxuICBhc3luYyB1cGRhdGUoeyBldmVudCwgYm9va2luZyB9KSB7XG4gICAgY29uc29sZS5sb2coYFJlbnRlciAke3RoaXMucmVudGVySWR9IG5vdGlmaWVkIG9mIGV2ZW50IFwiJHtldmVudH1cIiBvbiBib29raW5nICR7Ym9va2luZy5pZH1gKTtcblxuICAgIC8vIFBlcnNpc3QgdGhlIG5vdGlmaWNhdGlvbiBmb3IgdGhlIHJlbnRlci5cbiAgICB0cnkge1xuICAgICAgYXdhaXQgcHJpc21hLm5vdGlmaWNhdGlvbi5jcmVhdGUoe1xuICAgICAgICBkYXRhOiB7XG4gICAgICAgICAgdXNlcklkOiB0aGlzLnJlbnRlcklkLFxuICAgICAgICAgIGNvbnRlbnQ6IGBZb3VyIGJvb2tpbmcgKElEOiAke2Jvb2tpbmcuaWR9KSBmb3IgY2FyIChJRDogJHtib29raW5nLmNhcklkfSkgaGFzIGFuIHVwZGF0ZTogXCIke2V2ZW50fVwiLmBcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGNyZWF0aW5nIHJlbnRlciBub3RpZmljYXRpb246JywgZXJyb3IpO1xuICAgIH1cbiAgfVxufVxuXG5leHBvcnQgZGVmYXVsdCBSZW50ZXJCb29raW5nTm90aWZpY2F0aW9uU3Vic2NyaWJlcjtcbiJdLCJuYW1lcyI6WyJwcmlzbWEiLCJSZW50ZXJCb29raW5nTm90aWZpY2F0aW9uU3Vic2NyaWJlciIsImNvbnN0cnVjdG9yIiwicmVudGVySWQiLCJ1cGRhdGUiLCJldmVudCIsImJvb2tpbmciLCJjb25zb2xlIiwibG9nIiwiaWQiLCJub3RpZmljYXRpb24iLCJjcmVhdGUiLCJkYXRhIiwidXNlcklkIiwiY29udGVudCIsImNhcklkIiwiZXJyb3IiXSwiaWdub3JlTGlzdCI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./lib/RenterBookingNotificationSubscriber.js\n");

/***/ }),

/***/ "(rsc)/./lib/authMiddleware.js":
/*!*******************************!*\
  !*** ./lib/authMiddleware.js ***!
  \*******************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   authenticate: () => (/* binding */ authenticate)\n/* harmony export */ });\n/* harmony import */ var _sessionManager_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./sessionManager.js */ \"(rsc)/./lib/sessionManager.js\");\n// lib/authMiddleware.js\n\nasync function authenticate(req) {\n    const headerId = req.headers.get('x-user-id');\n    const userId = parseInt(headerId); // Could be a cookie or Authorization header\n    console.log('🔐 Authenticating userId:', userId);\n    if (!userId || !_sessionManager_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"].hasSession(userId)) {\n        return {\n            status: 401,\n            body: {\n                error: 'Unauthorized or session expired'\n            }\n        };\n    }\n    // Extend session and return session data\n    const session = _sessionManager_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"].getSession(userId);\n    return {\n        status: 200,\n        session,\n        userId\n    };\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9saWIvYXV0aE1pZGRsZXdhcmUuanMiLCJtYXBwaW5ncyI6Ijs7Ozs7QUFBQSx3QkFBd0I7QUFFd0I7QUFFekMsZUFBZUMsYUFBYUMsR0FBRztJQUNwQyxNQUFNQyxXQUFXRCxJQUFJRSxPQUFPLENBQUNDLEdBQUcsQ0FBQztJQUNqQyxNQUFNQyxTQUFTQyxTQUFTSixXQUFVLDRDQUE0QztJQUM5RUssUUFBUUMsR0FBRyxDQUFDLDZCQUE2Qkg7SUFDekMsSUFBSSxDQUFDQSxVQUFVLENBQUNOLDBEQUFjQSxDQUFDVSxVQUFVLENBQUNKLFNBQVM7UUFDakQsT0FBTztZQUNMSyxRQUFRO1lBQ1JDLE1BQU07Z0JBQUVDLE9BQU87WUFBa0M7UUFDbkQ7SUFDRjtJQUVBLHlDQUF5QztJQUN6QyxNQUFNQyxVQUFVZCwwREFBY0EsQ0FBQ2UsVUFBVSxDQUFDVDtJQUMxQyxPQUFPO1FBQUVLLFFBQVE7UUFBS0c7UUFBU1I7SUFBTztBQUN4QyIsInNvdXJjZXMiOlsiL1VzZXJzL2pvc2VwaGNvcm5lbGwvRGVza3RvcC80NzZHaXRodWJSZXBvL2RyaXZlc2hhcmVSZXBvL2xpYi9hdXRoTWlkZGxld2FyZS5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBsaWIvYXV0aE1pZGRsZXdhcmUuanNcblxuaW1wb3J0IHNlc3Npb25NYW5hZ2VyIGZyb20gJy4vc2Vzc2lvbk1hbmFnZXIuanMnXG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBhdXRoZW50aWNhdGUocmVxKSB7XG4gIGNvbnN0IGhlYWRlcklkID0gcmVxLmhlYWRlcnMuZ2V0KCd4LXVzZXItaWQnKTtcbiAgY29uc3QgdXNlcklkID0gcGFyc2VJbnQoaGVhZGVySWQpOy8vIENvdWxkIGJlIGEgY29va2llIG9yIEF1dGhvcml6YXRpb24gaGVhZGVyXG4gIGNvbnNvbGUubG9nKCfwn5SQIEF1dGhlbnRpY2F0aW5nIHVzZXJJZDonLCB1c2VySWQpO1xuICBpZiAoIXVzZXJJZCB8fCAhc2Vzc2lvbk1hbmFnZXIuaGFzU2Vzc2lvbih1c2VySWQpKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIHN0YXR1czogNDAxLFxuICAgICAgYm9keTogeyBlcnJvcjogJ1VuYXV0aG9yaXplZCBvciBzZXNzaW9uIGV4cGlyZWQnIH1cbiAgICB9XG4gIH1cblxuICAvLyBFeHRlbmQgc2Vzc2lvbiBhbmQgcmV0dXJuIHNlc3Npb24gZGF0YVxuICBjb25zdCBzZXNzaW9uID0gc2Vzc2lvbk1hbmFnZXIuZ2V0U2Vzc2lvbih1c2VySWQpXG4gIHJldHVybiB7IHN0YXR1czogMjAwLCBzZXNzaW9uLCB1c2VySWQgfVxufVxuIl0sIm5hbWVzIjpbInNlc3Npb25NYW5hZ2VyIiwiYXV0aGVudGljYXRlIiwicmVxIiwiaGVhZGVySWQiLCJoZWFkZXJzIiwiZ2V0IiwidXNlcklkIiwicGFyc2VJbnQiLCJjb25zb2xlIiwibG9nIiwiaGFzU2Vzc2lvbiIsInN0YXR1cyIsImJvZHkiLCJlcnJvciIsInNlc3Npb24iLCJnZXRTZXNzaW9uIl0sImlnbm9yZUxpc3QiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./lib/authMiddleware.js\n");

/***/ }),

/***/ "(rsc)/./lib/prisma.js":
/*!***********************!*\
  !*** ./lib/prisma.js ***!
  \***********************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony import */ var _prisma_client__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @prisma/client */ \"@prisma/client\");\n/* harmony import */ var _prisma_client__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_prisma_client__WEBPACK_IMPORTED_MODULE_0__);\n// lib/prisma.js\n\nlet globalWithPrisma = global;\nif (!globalWithPrisma.prisma) {\n    globalWithPrisma.prisma = new _prisma_client__WEBPACK_IMPORTED_MODULE_0__.PrismaClient();\n}\nconst prisma = globalWithPrisma.prisma;\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (prisma);\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9saWIvcHJpc21hLmpzIiwibWFwcGluZ3MiOiI7Ozs7OztBQUFBLGdCQUFnQjtBQUM2QjtBQUU3QyxJQUFJQyxtQkFBbUJDO0FBQ3ZCLElBQUksQ0FBQ0QsaUJBQWlCRSxNQUFNLEVBQUU7SUFDNUJGLGlCQUFpQkUsTUFBTSxHQUFHLElBQUlILHdEQUFZQTtBQUM1QztBQUNBLE1BQU1HLFNBQVNGLGlCQUFpQkUsTUFBTTtBQUV0QyxpRUFBZUEsTUFBTUEsRUFBQSIsInNvdXJjZXMiOlsiL1VzZXJzL2pvc2VwaGNvcm5lbGwvRGVza3RvcC80NzZHaXRodWJSZXBvL2RyaXZlc2hhcmVSZXBvL2xpYi9wcmlzbWEuanMiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gbGliL3ByaXNtYS5qc1xuaW1wb3J0IHsgUHJpc21hQ2xpZW50IH0gZnJvbSAnQHByaXNtYS9jbGllbnQnXG5cbmxldCBnbG9iYWxXaXRoUHJpc21hID0gZ2xvYmFsXG5pZiAoIWdsb2JhbFdpdGhQcmlzbWEucHJpc21hKSB7XG4gIGdsb2JhbFdpdGhQcmlzbWEucHJpc21hID0gbmV3IFByaXNtYUNsaWVudCgpXG59XG5jb25zdCBwcmlzbWEgPSBnbG9iYWxXaXRoUHJpc21hLnByaXNtYVxuXG5leHBvcnQgZGVmYXVsdCBwcmlzbWFcbiJdLCJuYW1lcyI6WyJQcmlzbWFDbGllbnQiLCJnbG9iYWxXaXRoUHJpc21hIiwiZ2xvYmFsIiwicHJpc21hIl0sImlnbm9yZUxpc3QiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./lib/prisma.js\n");

/***/ }),

/***/ "(rsc)/./lib/sessionManager.js":
/*!*******************************!*\
  !*** ./lib/sessionManager.js ***!
  \*******************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n// lib/sessionManager.js\nclass SessionManager {\n    constructor(){\n        this.sessions = new Map();\n        this.timeouts = new Map();\n    }\n    createSession(userId, data) {\n        console.log('🧠 [SessionManager] Creating session:', userId, data);\n        this.sessions.set(Number(userId), data);\n        this.setSessionTimeout(userId);\n    }\n    setSessionTimeout(userId) {\n        const id = Number(userId);\n        if (this.timeouts.has(id)) clearTimeout(this.timeouts.get(id));\n        const timeout = setTimeout(()=>this.removeSession(id), 30 * 60 * 1000);\n        this.timeouts.set(id, timeout);\n    }\n    hasSession(userId) {\n        return this.sessions.has(Number(userId));\n    }\n    getSession(userId) {\n        const id = Number(userId);\n        if (this.sessions.has(id)) {\n            this.setSessionTimeout(id);\n            return this.sessions.get(id);\n        }\n        return null;\n    }\n    removeSession(userId) {\n        const id = Number(userId);\n        this.sessions.delete(id);\n        if (this.timeouts.has(id)) {\n            clearTimeout(this.timeouts.get(id));\n            this.timeouts.delete(id);\n        }\n    }\n}\n// 👇 THIS is the real fix — use global to persist across requests\nconst globalForSession = globalThis;\nif (!globalForSession.sessionManager) {\n    globalForSession.sessionManager = new SessionManager();\n}\nconst sessionManager = globalForSession.sessionManager;\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (sessionManager);\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9saWIvc2Vzc2lvbk1hbmFnZXIuanMiLCJtYXBwaW5ncyI6Ijs7OztBQUFBLHdCQUF3QjtBQUV4QixNQUFNQTtJQUNKQyxhQUFjO1FBQ1osSUFBSSxDQUFDQyxRQUFRLEdBQUcsSUFBSUM7UUFDcEIsSUFBSSxDQUFDQyxRQUFRLEdBQUcsSUFBSUQ7SUFDdEI7SUFFQUUsY0FBY0MsTUFBTSxFQUFFQyxJQUFJLEVBQUU7UUFDMUJDLFFBQVFDLEdBQUcsQ0FBQyx5Q0FBeUNILFFBQVFDO1FBQzdELElBQUksQ0FBQ0wsUUFBUSxDQUFDUSxHQUFHLENBQUNDLE9BQU9MLFNBQVNDO1FBQ2xDLElBQUksQ0FBQ0ssaUJBQWlCLENBQUNOO0lBQ3pCO0lBRUFNLGtCQUFrQk4sTUFBTSxFQUFFO1FBQ3hCLE1BQU1PLEtBQUtGLE9BQU9MO1FBQ2xCLElBQUksSUFBSSxDQUFDRixRQUFRLENBQUNVLEdBQUcsQ0FBQ0QsS0FBS0UsYUFBYSxJQUFJLENBQUNYLFFBQVEsQ0FBQ1ksR0FBRyxDQUFDSDtRQUMxRCxNQUFNSSxVQUFVQyxXQUFXLElBQU0sSUFBSSxDQUFDQyxhQUFhLENBQUNOLEtBQUssS0FBSyxLQUFLO1FBQ25FLElBQUksQ0FBQ1QsUUFBUSxDQUFDTSxHQUFHLENBQUNHLElBQUlJO0lBQ3hCO0lBRUFHLFdBQVdkLE1BQU0sRUFBRTtRQUNqQixPQUFPLElBQUksQ0FBQ0osUUFBUSxDQUFDWSxHQUFHLENBQUNILE9BQU9MO0lBQ2xDO0lBRUFlLFdBQVdmLE1BQU0sRUFBRTtRQUNqQixNQUFNTyxLQUFLRixPQUFPTDtRQUNsQixJQUFJLElBQUksQ0FBQ0osUUFBUSxDQUFDWSxHQUFHLENBQUNELEtBQUs7WUFDekIsSUFBSSxDQUFDRCxpQkFBaUIsQ0FBQ0M7WUFDdkIsT0FBTyxJQUFJLENBQUNYLFFBQVEsQ0FBQ2MsR0FBRyxDQUFDSDtRQUMzQjtRQUNBLE9BQU87SUFDVDtJQUVBTSxjQUFjYixNQUFNLEVBQUU7UUFDcEIsTUFBTU8sS0FBS0YsT0FBT0w7UUFDbEIsSUFBSSxDQUFDSixRQUFRLENBQUNvQixNQUFNLENBQUNUO1FBQ3JCLElBQUksSUFBSSxDQUFDVCxRQUFRLENBQUNVLEdBQUcsQ0FBQ0QsS0FBSztZQUN6QkUsYUFBYSxJQUFJLENBQUNYLFFBQVEsQ0FBQ1ksR0FBRyxDQUFDSDtZQUMvQixJQUFJLENBQUNULFFBQVEsQ0FBQ2tCLE1BQU0sQ0FBQ1Q7UUFDdkI7SUFDRjtBQUNGO0FBRUEsa0VBQWtFO0FBQ2xFLE1BQU1VLG1CQUFtQkM7QUFFekIsSUFBSSxDQUFDRCxpQkFBaUJFLGNBQWMsRUFBRTtJQUNwQ0YsaUJBQWlCRSxjQUFjLEdBQUcsSUFBSXpCO0FBQ3hDO0FBRUEsTUFBTXlCLGlCQUFpQkYsaUJBQWlCRSxjQUFjO0FBQ3RELGlFQUFlQSxjQUFjQSxFQUFDIiwic291cmNlcyI6WyIvVXNlcnMvam9zZXBoY29ybmVsbC9EZXNrdG9wLzQ3NkdpdGh1YlJlcG8vZHJpdmVzaGFyZVJlcG8vbGliL3Nlc3Npb25NYW5hZ2VyLmpzIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIGxpYi9zZXNzaW9uTWFuYWdlci5qc1xuXG5jbGFzcyBTZXNzaW9uTWFuYWdlciB7XG4gIGNvbnN0cnVjdG9yKCkge1xuICAgIHRoaXMuc2Vzc2lvbnMgPSBuZXcgTWFwKCk7XG4gICAgdGhpcy50aW1lb3V0cyA9IG5ldyBNYXAoKTtcbiAgfVxuXG4gIGNyZWF0ZVNlc3Npb24odXNlcklkLCBkYXRhKSB7XG4gICAgY29uc29sZS5sb2coJ/Cfp6AgW1Nlc3Npb25NYW5hZ2VyXSBDcmVhdGluZyBzZXNzaW9uOicsIHVzZXJJZCwgZGF0YSk7XG4gICAgdGhpcy5zZXNzaW9ucy5zZXQoTnVtYmVyKHVzZXJJZCksIGRhdGEpO1xuICAgIHRoaXMuc2V0U2Vzc2lvblRpbWVvdXQodXNlcklkKTtcbiAgfVxuXG4gIHNldFNlc3Npb25UaW1lb3V0KHVzZXJJZCkge1xuICAgIGNvbnN0IGlkID0gTnVtYmVyKHVzZXJJZCk7XG4gICAgaWYgKHRoaXMudGltZW91dHMuaGFzKGlkKSkgY2xlYXJUaW1lb3V0KHRoaXMudGltZW91dHMuZ2V0KGlkKSk7XG4gICAgY29uc3QgdGltZW91dCA9IHNldFRpbWVvdXQoKCkgPT4gdGhpcy5yZW1vdmVTZXNzaW9uKGlkKSwgMzAgKiA2MCAqIDEwMDApO1xuICAgIHRoaXMudGltZW91dHMuc2V0KGlkLCB0aW1lb3V0KTtcbiAgfVxuXG4gIGhhc1Nlc3Npb24odXNlcklkKSB7XG4gICAgcmV0dXJuIHRoaXMuc2Vzc2lvbnMuaGFzKE51bWJlcih1c2VySWQpKTtcbiAgfVxuXG4gIGdldFNlc3Npb24odXNlcklkKSB7XG4gICAgY29uc3QgaWQgPSBOdW1iZXIodXNlcklkKTtcbiAgICBpZiAodGhpcy5zZXNzaW9ucy5oYXMoaWQpKSB7XG4gICAgICB0aGlzLnNldFNlc3Npb25UaW1lb3V0KGlkKTtcbiAgICAgIHJldHVybiB0aGlzLnNlc3Npb25zLmdldChpZCk7XG4gICAgfVxuICAgIHJldHVybiBudWxsO1xuICB9XG5cbiAgcmVtb3ZlU2Vzc2lvbih1c2VySWQpIHtcbiAgICBjb25zdCBpZCA9IE51bWJlcih1c2VySWQpO1xuICAgIHRoaXMuc2Vzc2lvbnMuZGVsZXRlKGlkKTtcbiAgICBpZiAodGhpcy50aW1lb3V0cy5oYXMoaWQpKSB7XG4gICAgICBjbGVhclRpbWVvdXQodGhpcy50aW1lb3V0cy5nZXQoaWQpKTtcbiAgICAgIHRoaXMudGltZW91dHMuZGVsZXRlKGlkKTtcbiAgICB9XG4gIH1cbn1cblxuLy8g8J+RhyBUSElTIGlzIHRoZSByZWFsIGZpeCDigJQgdXNlIGdsb2JhbCB0byBwZXJzaXN0IGFjcm9zcyByZXF1ZXN0c1xuY29uc3QgZ2xvYmFsRm9yU2Vzc2lvbiA9IGdsb2JhbFRoaXM7XG5cbmlmICghZ2xvYmFsRm9yU2Vzc2lvbi5zZXNzaW9uTWFuYWdlcikge1xuICBnbG9iYWxGb3JTZXNzaW9uLnNlc3Npb25NYW5hZ2VyID0gbmV3IFNlc3Npb25NYW5hZ2VyKCk7XG59XG5cbmNvbnN0IHNlc3Npb25NYW5hZ2VyID0gZ2xvYmFsRm9yU2Vzc2lvbi5zZXNzaW9uTWFuYWdlcjtcbmV4cG9ydCBkZWZhdWx0IHNlc3Npb25NYW5hZ2VyO1xuIl0sIm5hbWVzIjpbIlNlc3Npb25NYW5hZ2VyIiwiY29uc3RydWN0b3IiLCJzZXNzaW9ucyIsIk1hcCIsInRpbWVvdXRzIiwiY3JlYXRlU2Vzc2lvbiIsInVzZXJJZCIsImRhdGEiLCJjb25zb2xlIiwibG9nIiwic2V0IiwiTnVtYmVyIiwic2V0U2Vzc2lvblRpbWVvdXQiLCJpZCIsImhhcyIsImNsZWFyVGltZW91dCIsImdldCIsInRpbWVvdXQiLCJzZXRUaW1lb3V0IiwicmVtb3ZlU2Vzc2lvbiIsImhhc1Nlc3Npb24iLCJnZXRTZXNzaW9uIiwiZGVsZXRlIiwiZ2xvYmFsRm9yU2Vzc2lvbiIsImdsb2JhbFRoaXMiLCJzZXNzaW9uTWFuYWdlciJdLCJpZ25vcmVMaXN0IjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./lib/sessionManager.js\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../webpack-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next"], () => (__webpack_exec__("(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader/index.js?name=app%2Fapi%2Fbookings%2Froute&page=%2Fapi%2Fbookings%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fbookings%2Froute.js&appDir=%2FUsers%2Fjosephcornell%2FDesktop%2F476GithubRepo%2FdriveshareRepo%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Fjosephcornell%2FDesktop%2F476GithubRepo%2FdriveshareRepo&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!")));
module.exports = __webpack_exports__;

})();